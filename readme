HomeTasks - EspecificaciÃ³n TÃ©cnica para MVC

ğŸ“± Screenshots & Demo
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ  HomeTasks - Dashboard                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Esta Semana (3/5 completadas) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚ Cocinaâ”‚ BaÃ±o  â”‚Comedorâ”‚ Patio â”‚  â†’    â”‚
â”‚ â”‚  âœ“    â”‚  âœ“    â”‚  âœ“    â”‚   â˜   â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚ Este Mes (1/3 completadas) â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚ â”‚Ventanasâ”‚ Horno â”‚Alfombraâ”‚         â†’    â”‚
â”‚ â”‚  âœ“    â”‚   â˜   â”‚   â˜   â”‚               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Stack TecnolÃ³gico

Framework: Next.js 15 (App Router)
Base de Datos: Turso (SQLite) con Drizzle ORM
AutenticaciÃ³n: NextAuth.js v5
UI: Tailwind CSS + shadcn/ui
ValidaciÃ³n: Zod
Estado: TanStack Query (React Query)
Deploy: Vercel

Estructura de Datos
Modelo de Base de Datos (Drizzle Schema)
typescript// lib/db/schema.ts
import { sqliteTable, text, integer } from 'drizzle-orm/sqlite-core';

export const users = sqliteTable('users', {
  id: text('id').primaryKey(),
  email: text('email').unique().notNull(),
  name: text('name'),
  passwordHash: text('password_hash').notNull(),
  createdAt: integer('created_at', { mode: 'timestamp' }),
  updatedAt: integer('updated_at', { mode: 'timestamp' }),
});

export const areas = sqliteTable('areas', {
  id: text('id').primaryKey(),
  name: text('name').notNull(),
  color: text('color').default('#3B82F6'),
  userId: text('user_id').references(() => users.id),
  createdAt: integer('created_at', { mode: 'timestamp' }),
});

export const tasks = sqliteTable('tasks', {
  id: text('id').primaryKey(),
  name: text('name').notNull(),
  description: text('description'),
  frequency: text('frequency', { 
    enum: ['WEEKLY', 'MONTHLY', 'QUARTERLY', 'BIANNUAL', 'ANNUAL'] 
  }).notNull(),
  areaId: text('area_id').references(() => areas.id),
  userId: text('user_id').references(() => users.id).notNull(),
  startDate: integer('start_date', { mode: 'timestamp' }).notNull(),
  weekOfMonth: integer('week_of_month'), // 1-4 para mensual
  monthsArray: text('months_array'), // JSON ["1","4","7","10"] trimestral
  isActive: integer('is_active', { mode: 'boolean' }).default(true),
  createdAt: integer('created_at', { mode: 'timestamp' }),
  updatedAt: integer('updated_at', { mode: 'timestamp' }),
});

export const completions = sqliteTable('completions', {
  id: text('id').primaryKey(),
  taskId: text('task_id').references(() => tasks.id).notNull(),
  completedAt: integer('completed_at', { mode: 'timestamp' }),
  period: text('period').notNull(), // "2024-W03", "2024-01", "2024-Q1"
});
API Endpoints (Next.js API Routes)
AutenticaciÃ³n

POST /api/auth/signup - Registro de usuario
POST /api/auth/signin - Login
POST /api/auth/signout - Logout

Tareas

GET /api/tasks - Listar tareas del usuario
POST /api/tasks - Crear tarea
PUT /api/tasks/[id] - Editar tarea
DELETE /api/tasks/[id] - Eliminar tarea
POST /api/tasks/[id]/complete - Marcar como completada
DELETE /api/tasks/[id]/complete - Desmarcar completada

Ãreas

GET /api/areas - Listar Ã¡reas del usuario
POST /api/areas - Crear Ã¡rea
PUT /api/areas/[id] - Editar Ã¡rea
DELETE /api/areas/[id] - Eliminar Ã¡rea

Dashboard

GET /api/dashboard - Datos del dashboard con tareas por periodicidad

Estructura de Carpetas
app/
â”œâ”€â”€ (auth)/
â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â””â”€â”€ register/
â”‚       â””â”€â”€ page.tsx
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ page.tsx
â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ edit/
â”‚   â”‚           â””â”€â”€ page.tsx
â”‚   â””â”€â”€ areas/
â”‚       â”œâ”€â”€ page.tsx
â”‚       â””â”€â”€ new/
â”‚           â””â”€â”€ page.tsx
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â””â”€â”€ [...nextauth]/
â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”œâ”€â”€ route.ts
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â”œâ”€â”€ route.ts
â”‚   â”‚       â””â”€â”€ complete/
â”‚   â”‚           â””â”€â”€ route.ts
â”‚   â”œâ”€â”€ areas/
â”‚   â”‚   â”œâ”€â”€ route.ts
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â””â”€â”€ dashboard/
â”‚       â””â”€â”€ route.ts
â”œâ”€â”€ layout.tsx
â””â”€â”€ page.tsx

components/
â”œâ”€â”€ ui/ (shadcn/ui components)
â”œâ”€â”€ forms/
â”‚   â”œâ”€â”€ task-form.tsx
â”‚   â”œâ”€â”€ area-form.tsx
â”‚   â””â”€â”€ login-form.tsx
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ task-slider.tsx
â”‚   â”œâ”€â”€ progress-bar.tsx
â”‚   â””â”€â”€ period-section.tsx
â””â”€â”€ layout/
    â”œâ”€â”€ header.tsx
    â”œâ”€â”€ sidebar.tsx
    â””â”€â”€ footer.tsx

lib/
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ index.ts (conexiÃ³n Turso)
â”‚   â””â”€â”€ schema.ts
â”œâ”€â”€ auth.ts (NextAuth config)
â”œâ”€â”€ validations.ts (Zod schemas)
â”œâ”€â”€ utils.ts
â””â”€â”€ constants.ts
Tipos TypeScript
typescript// types/index.ts

export type Frequency = 'WEEKLY' | 'MONTHLY' | 'QUARTERLY' | 'BIANNUAL' | 'ANNUAL';

export interface User {
  id: string;
  email: string;
  name?: string;
  createdAt: Date;
  updatedAt: Date;
}

export interface Area {
  id: string;
  name: string;
  color: string;
  userId: string;
  createdAt: Date;
}

export interface Task {
  id: string;
  name: string;
  description?: string;
  frequency: Frequency;
  areaId?: string;
  area?: Area;
  userId: string;
  startDate: Date;
  weekOfMonth?: number; // 1-4
  monthsArray?: string; // JSON array
  isActive: boolean;
  createdAt: Date;
  updatedAt: Date;
  completions: Completion[];
}

export interface Completion {
  id: string;
  taskId: string;
  completedAt: Date;
  period: string;
}

export interface DashboardData {
  weekly: TaskWithCompletion[];
  monthly: TaskWithCompletion[];
  quarterly: TaskWithCompletion[];
  biannual: TaskWithCompletion[];
  annual: TaskWithCompletion[];
}

export interface TaskWithCompletion extends Task {
  isCompleted: boolean;
  dueDate: Date;
  period: string;
}
LÃ³gica de Negocio Clave
CÃ¡lculo de Fechas de Vencimiento
typescript// lib/date-utils.ts

export function calculateNextDueDate(task: Task, currentDate: Date = new Date()): Date {
  const { frequency, startDate, weekOfMonth, monthsArray } = task;
  
  switch (frequency) {
    case 'WEEKLY':
      // Cada 7 dÃ­as desde startDate
      const weeksDiff = Math.floor((currentDate.getTime() - startDate.getTime()) / (7 * 24 * 60 * 60 * 1000));
      return new Date(startDate.getTime() + ((weeksDiff + 1) * 7 * 24 * 60 * 60 * 1000));
    
    case 'MONTHLY':
      // Semana especÃ­fica del mes
      return calculateMonthlyDate(currentDate, weekOfMonth || 1);
    
    case 'QUARTERLY':
    case 'BIANNUAL':
    case 'ANNUAL':
      // Usar monthsArray para determinar meses especÃ­ficos
      const months = JSON.parse(monthsArray || '[]');
      return calculatePeriodicDate(currentDate, months, frequency);
    
    default:
      return new Date();
  }
}

export function generatePeriodKey(date: Date, frequency: Frequency): string {
  const year = date.getFullYear();
  
  switch (frequency) {
    case 'WEEKLY':
      const week = getWeekNumber(date);
      return `${year}-W${week.toString().padStart(2, '0')}`;
    case 'MONTHLY':
      const month = date.getMonth() + 1;
      return `${year}-${month.toString().padStart(2, '0')}`;
    case 'QUARTERLY':
      const quarter = Math.floor(date.getMonth() / 3) + 1;
      return `${year}-Q${quarter}`;
    case 'BIANNUAL':
      const half = date.getMonth() < 6 ? 1 : 2;
      return `${year}-H${half}`;
    case 'ANNUAL':
      return `${year}`;
    default:
      return `${year}`;
  }
}
Validaciones Zod
typescript// lib/validations.ts

import { z } from 'zod';

export const createTaskSchema = z.object({
  name: z.string().min(1, 'Nombre requerido').max(100),
  description: z.string().optional(),
  frequency: z.enum(['WEEKLY', 'MONTHLY', 'QUARTERLY', 'BIANNUAL', 'ANNUAL']),
  areaId: z.string().optional(),
  startDate: z.date(),
  weekOfMonth: z.number().min(1).max(4).optional(),
  monthsArray: z.array(z.number().min(1).max(12)).optional(),
});

export const createAreaSchema = z.object({
  name: z.string().min(1, 'Nombre requerido').max(50),
  color: z.string().regex(/^#[0-9A-F]{6}$/i, 'Color hexadecimal vÃ¡lido'),
});

export const loginSchema = z.object({
  email: z.string().email('Email vÃ¡lido requerido'),
  password: z.string().min(6, 'MÃ­nimo 6 caracteres'),
});

export const registerSchema = loginSchema.extend({
  name: z.string().min(2, 'Nombre requerido'),
  confirmPassword: z.string(),
}).refine((data) => data.password === data.confirmPassword, {
  message: 'Las contraseÃ±as no coinciden',
  path: ['confirmPassword'],
});
PÃ¡ginas Principales
Dashboard (/dashboard)

Mostrar sliders horizontales por periodicidad
Cada slider muestra tareas pendientes/completadas
Checkbox para marcar/desmarcar completadas
Contadores de progreso visuales
Filtros por Ã¡rea

GestiÃ³n de Tareas (/dashboard/tasks)

Lista completa de tareas
Botones para crear/editar/eliminar
Filtros por Ã¡rea y periodicidad
BÃºsqueda por nombre

GestiÃ³n de Ãreas (/dashboard/areas)

Lista de Ã¡reas con colores
CRUD completo de Ã¡reas
Contador de tareas por Ã¡rea

Variables de Entorno
env# Turso Database
TURSO_DATABASE_URL="libsql://[db-name]-[org].turso.io"
TURSO_AUTH_TOKEN="your-auth-token"

# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret"

# Optional OAuth
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""
Dependencias package.json
json{
  "dependencies": {
    "next": "^15.0.0",
    "react": "^19.0.0",
    "react-dom": "^19.0.0",
    "@libsql/client": "^0.4.0",
    "drizzle-orm": "^0.29.0",
    "drizzle-kit": "^0.20.0",
    "next-auth": "^5.0.0-beta.4",
    "bcryptjs": "^2.4.3",
    "@tanstack/react-query": "^5.0.0",
    "zod": "^3.22.0",
    "tailwindcss": "^3.4.0",
    "@radix-ui/react-slot": "^1.0.0",
    "lucide-react": "^0.300.0",
    "date-fns": "^3.0.0"
  },
  "devDependencies": {
    "typescript": "^5.0.0",
    "@types/node": "^20.0.0",
    "@types/react": "^18.0.0",
    "@types/bcryptjs": "^2.4.0"
  }
}